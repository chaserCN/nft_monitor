# Как получить токен для Portals API

Для работы с API Portals Marketplace нужно получить токен авторизации из веб-версии Telegram.

## Пошаговая инструкция

### 1. Откройте Telegram Web
Перейдите на https://web.telegram.org и войдите в свой аккаунт Telegram.

### 2. Найдите Portals бота
В поиске найдите `@portals_market_bot` и откройте его.

### 3. Запустите Mini App
Нажмите на кнопку "Open App" или "Открыть приложение", чтобы запустить мини-приложение Portals внутри Telegram.

### 4. Откройте DevTools
- **Windows/Linux**: Нажмите `F12` или `Ctrl+Shift+I`
- **Mac**: Нажмите `Cmd+Option+I`

### 5. Перейдите во вкладку Network
В DevTools найдите и откройте вкладку "Network" (Сеть).

### 6. Фильтр по домену
В поле фильтра введите `portalsmarket.co`, чтобы видеть только запросы к API Portals.

### 7. Выполните действие в приложении
Кликните на что-нибудь в приложении Portals (например, откройте каталог подарков), чтобы генерировались запросы к API.

### 8. Найдите запрос к API
Вы увидите список запросов к `portalsmarket.co`. Кликните на любой из них.

### 9. Скопируйте Authorization заголовок
В правой панели найдите раздел "Request Headers" (Заголовки запроса).

Найдите заголовок `Authorization`, его значение будет выглядеть примерно так:
```
tma eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...очень_длинная_строка...
```

Скопируйте **всё значение целиком**, включая `tma ` в начале.

### 10. Добавьте в .env файл
Создайте файл `.env` в корне проекта (если его нет) и добавьте:

```env
PORTALS_AUTH_DATA=tma eyJhbGciOi...ваш_токен_здесь...
```

## Важно!

- **Токен expires**: Токены обычно действуют 1-7 дней, потом нужно получать новый
- **Приватность**: Не делитесь своим токеном, это ваш персональный ключ доступа
- **Git**: Файл `.env` уже добавлен в `.gitignore`, он не будет загружен в репозиторий

## Проверка токена

После получения токена запустите тестовый скрипт:

```bash
python3 test_portals_simple.py
```

Если токен правильный, вы увидите список коллекций и подарков.

## Альтернативный способ (программный)

Библиотека `portalsmp` также поддерживает получение токена через Telegram API:

```python
from portalsmp import update_auth
import asyncio

# Получите api_id и api_hash на https://my.telegram.org/auth
api_id = your_api_id
api_hash = "your_api_hash"

token = asyncio.run(update_auth(api_id, api_hash))
print(f"Your token: {token}")
```

Этот метод сложнее, но токены живут дольше.
